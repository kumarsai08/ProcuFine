<!--
* 
* @ Name    :   pFQAManagerComponent
* @ Purpose :   The table displays information on a list of orders with their related product information.
*               The table allows searching by order ID and filtering by product name, and includes a button to open a modal popup for performing a quality check on a selected order.
* @ Author  :   Srikanth,Hima Bindu,Manogna,Kumar Sai
*
*   Date            |  Developer Name                 |  Version      |  Changes
* ======================================================================================================
*   26-12-2022      |  manogna.koppula@absyz.com      |  1.0          |  Initial Version
*                      himabindu.vanaparthi@absyz.com
*                      srikanth.halavath@absyz.com
*                      kumarsai.vadapalli@absyz.com
*
-->
<template>
    <div class="slds-box slds-theme_default">
        <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered">
            <thead>
                <tr>
                    <th class="" scope="col">
                      <lightning-input type="search" onchange={handleKeyChange} class="slds-m-bottom_small" label="Order ID" value={searchKey}></lightning-input>
                      </th>
                      <th class="" scope="col">
                        <lightning-combobox
                        name="Product Name"
                        label="Product Name"
                        value={value}
                        options={list_ProductNameFilterInQA}
                        onchange={handleProductFilterInQA} >
                        </lightning-combobox>
                      </th>
                        <th class="" scope="col">
                          <div class="slds-truncate" title="Pending Quantity">Pending Quantity</div>
                        </th>
                        <th class="" scope="col">
                          <div class="slds-truncate" title="Orders Received">Orders Received</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Under QA">Under QA</div>
                          </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Approved Quantity">Approved Quantity</div>
                          </th>
                          <th class="" scope="col">
                            <div class="slds-truncate" title="Rejected Quantity">Rejected Quantity</div>
                          </th>
                           <th class="" scope="col">
                            <div class="slds-truncate" title="QA Check">QA Check</div>
                          </th>
                </tr>
            </thead>
            <tbody>
                <template for:each={list_QATableList} for:item="ordPro">
                    <tr key={ordPro.Id}>
                      <td><a  name={ordPro.Id} data-strorderid= {ordPro.Order.Id}  onclick={Navigatetoorder}  target="_blank">{ordPro.Order.OrderNumber}</a></td> 
                      <td><a  name={ordPro.Id} data-strproducturl= {ordPro.Product2Id}  onclick={Navigatetoproduct}  target="_blank">{ordPro.Product2.Name}</a></td>
                        <td>{ordPro.Order.Pending_Quantityy1__c}</td>
                        <td>{ordPro.Order.On_Hand_Recieved__c}</td>
                        <td> {ordPro.Order.Under_QA__c} </td>
                        <td>{ordPro.Order.Approved_Quantity__c}</td>
                        <td>{ordPro.Order.Reject_Quantity__c}</td>
                        <td> 
                          <template if:true={ordPro.Order.Under_QA__c}>
                          <lightning-button variant="brand" label="Inspect"  data-set={ordPro.Order.Id} data-proid={ordPro.Product2.Id} onclick={handleClick} class="slds-m-left_x-small">Inspect</lightning-button>
                        </template>
                        </td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div> 
    <template if:true={blnIsShowModal}>
      <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
          aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
          <div class="slds-modal__container">
              <header class="slds-modal__header">
                  <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                      title="Close" onclick={handleBack}>
                      <lightning-icon icon-name="utility:close" alternative-text="close" label="Select One Record"
                          variant="inverse" size="small" onclick={closeThePopup}></lightning-icon>
                      <span class="slds-assistive-text">Close</span>
                  </button>
                  <div>
                     <h2 id="modal-heading-06" class="slds-text-heading_medium slds-text-align_left">Products Quality Check
                      </h2>
                  </div>
              </header>
              <div class="slds-modal__content slds-p-horizontal_xx-small " id="modal-content-id-5">
                  <lightning-card>
                      <table class="slds-table slds-table_cell-buffer slds-p-horizontal_xx-small" border="1"
                          cellspacing="0" cellpadding="0" bordercolor="#ccc" style="border-collapse:collapse;">
                          <thead>
                              <tr class="slds-table-height_reset">
                                <th class="" scope="col">
                                  <div class="slds-truncate" title="Product Name">Product Name</div>
                                </th>
                                <th class="" scope="col">
                                  <div class="slds-truncate" title="Product Name">Delivery Date</div>
                                </th>
                                <th class="" scope="col">
                                  <div class="slds-truncate" title="Product Name">Batch Number</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="slds-truncate" title="Product Name">SKU-Ids</div>
                                  </th>
                                  <th class="" scope="col">
                                      <div class="slds-truncate" title="Batch Number">Status</div>
                                    </th> 
                              </tr>
                          </thead>
                          <tbody>
                              <template for:each={list_Asset} for:item="asset">
                                  <tr key={asset.Id}>
                                    <td>{asset.Product2.Name}</td>
                                    <td> {asset.Batch_Number_lookup__r.Delivery_date__c}</td>
                                    <td><a   data-batchid= {asset.Batch_Number_lookup__c}  onclick={NavigatetoBatchnumber}  target="_blank">{asset.Batch_Number_lookup__r.Name}</a></td>
                                      <td>{asset.SKU_Id__c}</td>
                                        <td>
                                         <lightning-combobox
                                        name="Status"
                                        label="Status"
                                        value={value}
                                        placeholder="Select Progress"
                                        options={options}
                                        onchange={handlestatusupdation} data-assetid={asset.Id} ></lightning-combobox></td>
                                  </tr>
                              </template>
                          </tbody>
                      </table>
                  </lightning-card>
              </div>              
         <footer class="slds-modal__footer">
            <lightning-button variant="success" label="Save"  onclick={hideModalBox} class="slds-m-left_x-small"></lightning-button>
         </footer>
      </div>
   </section>
   <div class="slds-backdrop slds-backdrop_open"></div>
   </template>  
   <template if:true={blnLoading}>
    <div class="spinner">
        please wait....
        <lightning-spinner alternative-text="Loading"  size="large"></lightning-spinner>
    </div>
  </template> 
</template>